@model TheProject.ReportWebApplication.Models.HomeModel
@{
    ViewBag.Title = "Home Page";
}
<div class="block-header">
    <div class="row">
        <div class="col-lg-4 col-md-12 col-sm-12">
            <h2 class="margin-50">Dashboard</h2>
        </div>
        <div class="col-lg-8 col-md-8 col-sm-12 margin-top-25">

            <div class="row">
                <label class="control-label col-lg-2 col-md-2 col-sm-12 padding-5">Region</label>
                <div class="col-lg-4 col-md-4 col-sm-4">
                    @Html.DropDownList("Region", (SelectList)ViewBag.Regions, string.Empty, new { @class = "form-control", @id = "dropDownId" })
                </div>
                <div class="col-lg-4 col-md-4 col-sm-4">
                    <input type="submit" id="filterByRegionBtn" value="Filter By Region" class="btn btn-success" />
                </div>
                <div class="col-lg-2 col-md-2 col-sm-12">
                    <input type="submit" id="claerBtn" value="Claer" class="btn btn-light claer-btn" />
                </div>
            </div>

        </div>
    </div>
</div>

<div class="container-fluid">
    <div class="row clearfix">
        <div class="col-lg-3 col-md-6 col-sm-12 width-100">
            <div class="dashboard-card" style="color:white; background-color: orange; text-align: center;">
                <div class="card-body" style="color:#FFFFFF">
                    <h3 style="color:white !important;" class="m-b-0 number count-to" data-from="0" data-to="1600" data-speed="2000" data-fresh-interval="700" id="PropertiesCount">@Model.PropertiesCount</h3>
                    <p class="text-muted">Number of properties</p>
                    <div class="progress">
                        <div class="progress-bar l-blush" role="progressbar" aria-valuenow="24" aria-valuemin="0" aria-valuemax="100" id="propertiesPercentageProgressbar" style="width: @ViewData["PropertiesPercentage"]%;"></div>
                    </div>
                    <small class="percentage">Signed Off <span id="PropertiesPercentage">@Model.PropertiesPercentage</span><span>%</span></small>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-12 width-100">
            <div class="dashboard-card" style="background-color: green; color:#FFFFFF">
                <div class="card-body" style="color:#FFFFFF; text-align: center; padding: 7px 10px;">
                    <i style="font-size: xx-large;" class="fa fa-building" aria-hidden="true"></i>
                    <div class="dashboard-number" style="color:#FFFFFF" id="noOfImprovements">@Model.NoOfImprovements</div>
                    <div class="dashboard-text" style="color:#FFFFFF">Number of improvements</div>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-12 width-100">
            <div class="dashboard-card" style="background-color: orangered; color:#FFFFFF">
                <div class="card-body" style="color:#FFFFFF; text-align: center; padding: 7px 10px;">
                    <div class="dashboard-icon"><i style="font-size: xx-large;" class="fa fa-level-up" aria-hidden="true"></i></div>
                    <div class="dashboard-number" style="color:#FFFFFF"><span id="ImprovementsSize">@Model.ImprovementsSize</span><span>m&#178;</span></div>
                    <div class="dashboard-text" style="color:#FFFFFF">Size of improvements</div>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-12 width-100">
            <div class="dashboard-card" style="background-color: purple; color:#FFFFFF">
                <div class="card-body" style="color:#FFFFFF; text-align: center; padding: 7px 10px;">
                    <div class="dashboard-icon"><i style="font-size: xx-large; color:#FFFFFF" class="fa fa-arrows-h" aria-hidden="true"></i></div>
                    <div class="dashboard-number" style="color:#FFFFFF"><span id="OccupationStatus">@Model.OccupationStatus</span><span>%</span></div>
                    <div class="dashboard-text" style="color:#FFFFFF">Occupation Status</div>
                </div>
            </div>
        </div>
    </div>

    <div class="container-fluid" style="background: #101e45;border-radius: .55rem;margin-bottom: 30px;transition: .5s; border: 0; position: relative; width: 100%; box-shadow: 0 1px 4px 0 rgba(0,0,0,0.1);">
        <div class="row clearfix" style="margin-bottom: 15px;">
            <div class="col-lg-3 col-md-3 col-sm-12 width-100" style="text-align: center;">
                <canvas id="demo" width="200" height="200"></canvas><br />
                <label class="propertyDescription" style="color: yellow">Public open space</label>
            </div>
            <div class="col-lg-3 col-md-3 col-sm-12 width-100" style="text-align: center;">
                <canvas id="demo1" width="200" height="200"></canvas><br />
                <label class="propertyDescription" style="color: red">Roads</label>
            </div>
            <div class="col-lg-3 col-md-3 col-sm-12 width-100" style="text-align: center;">
                <canvas id="demo2" width="200" height="200"></canvas><br />
                <label class="propertyDescription" style="color: white">Agriculture</label>
            </div>
            <div class="col-lg-3 col-md-3 col-sm-12 width-100" style="text-align: center;">
                <canvas id="demo3" width="200" height="200"></canvas><br />
                <label class="propertyDescription" style="color: orange">Special</label>
            </div>
        </div>
    </div>
    <div class="clearfix margin-55">
        <div class="row">
            <div class="col-lg-6 col-md-6 col-sm-6 width-100">
                <label class="header2">Property Type / Zoning</label>
            </div>
            <div class="col-lg-6 col-md-6 col-sm-12 width-100" style="text-align: right;">
                <label class="label-underline" id="showTableView">Table View</label>
                <label class="label-underline" id="showGraphView">Graph View</label>
            </div>
        </div>
    </div>
        <div class="clearfix margin-55">
            <div class="col-lg-12" id="propertyTypeTableDiv">
                <div class="col-lg-12" style="background-color: lightgray;border-radius: .55rem; margin-bottom: 30px; transition: .5s; border: 0;    padding: 15px;
                        position: relative;
                        width: 100%;
                            box-shadow: 0 1px 4px 0 rgba(0,0,0,0.1);">

                    <table class="table table-hover" id="records_table">
                        <thead style="background-color: #101e45;color: white;">
                            <tr>
                                <th>Property Type</th>
                                <th>Signed Off</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="col-lg-12" id="propertyTypeGraphDiv">
                <div class="col-lg-12" style="background-color: darkturquoise;border-radius: .55rem; margin-bottom: 30px; transition: .5s; border: 0;    padding: 15px;
                        position: relative;
                        width: 100%;
                            box-shadow: 0 1px 4px 0 rgba(0,0,0,0.1);">
                    <div Style="font-family: Corbel; font-size: small ;text-align:center ; padding: 15px;" class="row">
                        <div id="graph-container" style="width:100%;height:100%;margin-left: 5px;">
                            <canvas id="myChart" style="padding: 0;margin: auto;display: block; "> </canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    @*<div class="property-type-header">
                <h2><small>Property Type</small></h2>
            </div>
            <div class="row property-type">

                <br />
                @foreach (var item in Model.DataPoints)
                    {
                        <div class="row property-type-row">
                            <div class="property-type-card col-lg-12 col-md-12 col-sm-12" style="background-color: @item.Color;">
                                <div class="dashboard-content" style="color:#FFFFFF">
                                    <div class="dashboard-number" style="color:#FFFFFF"><span>@item.Y</span></div>
                                    <div class="dashboard-text" style="color:#FFFFFF">@item.Label</div>
                                </div>
                            </div>
                        </div>
                    }*
                <div Style="font-family: Corbel; font-size: small ;text-align:center ; padding: 15px;" class="row">
                    <div style="width:100%;height:100%;margin-left: 5px;">
                        <canvas id="myChart" style="padding: 0;margin: auto;display: block; "> </canvas>
                    </div>
                </div>
            </div>
        </div>*@

    <script>
        $("#propertyTypeTableDiv").fadeIn();
        $("#propertyTypeGraphDiv").fadeOut();

        $("#showTableView").click(function () {
            $("#propertyTypeTableDiv").fadeIn();
            $("#propertyTypeGraphDiv").fadeOut();
        });

        $("#showGraphView").click(function () {
            $("#propertyTypeGraphDiv").fadeIn();
            $("#propertyTypeTableDiv").fadeOut();
        });

        $('#claerBtn').click(function () {
            $.ajax({
                type: "POST",
                url: "/Home/NewChart",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (chData) {
                    var aData = chData;
                    $("#noOfImprovements").empty().append(aData[3]).find('#noOfImprovements');
                    $("#PropertiesCount").empty().append(aData[4]).find('#PropertiesCount');
                    $("#ImprovementsSize").empty().append(aData[5]).find('#ImprovementsSize');
                    $("#OccupationStatus").empty().append(aData[6]).find('#OccupationStatus');
                    $("#PropertiesPercentage").empty().append(aData[7]).find('#PropertiesPercentage');
                    var dsf = aData[7] + '%';
                    $("#propertiesPercentageProgressbar").css({ width: dsf });
                    var aLabels = aData[0];
                    var aDatasets1 = aData[1];
                    var dataT = {
                        labels: aLabels,
                        datasets: [{
                            label: "Clear Data",
                            data: aDatasets1,
                            fill: true,
                            backgroundColor: aData[2],
                            borderColor: aData[2],
                            borderWidth: 1
                        }]
                    };
                    $('#records_table tbody').empty();
                    var trHTML = '';
                    $("#demo").gauge(0, { min: 0, max: 100, unit: "/0", color: "yellow", colorAlpha: 1, bgcolor: "#696969", type: "default" });
                    $("#demo1").gauge(0, { min: 0, max: 100, unit: "/0", color: "red", colorAlpha: 1, bgcolor: "#696969", type: "default" });
                    $("#demo2").gauge(0, { min: 0, max: 100, unit: "/0", color: "white", colorAlpha: 1, bgcolor: "#696969", type: "default" });
                    $("#demo3").gauge(0, { min: 0, max: 100, unit: "/0", color: "orange", colorAlpha: 1, bgcolor: "#696969", type: "default" });
                    $.each(aData[8], function (i, item) {
                        if (item.Label.toLowerCase().trim() == 'public open space') {
                            $("#demo").gauge(item.Y, { min: 0, max: item.Total, unit: "/" + item.Total, color: "yellow", colorAlpha: 3, bgcolor: "#696969", type: "default" });
                        }
                        if (item.Label.toLowerCase().trim() == 'roads') {
                            $("#demo1").gauge(item.Y, { min: 0, max: item.Total, unit: "/" + item.Total, color: "red", colorAlpha: 2, bgcolor: "#696969", type: "default" });
                        }
                        if (item.Label.toLowerCase().trim() == 'agriculture') {
                            $("#demo2").gauge(item.Y, { min: 0, max: item.Total, unit: "/" + item.Total, color: "white", colorAlpha: 1, bgcolor: "#696969", type: "default" });
                        }
                        if (item.Label.toLowerCase().trim() == 'special') {
                            $("#demo3").gauge(item.Y, { min: 0, max: item.Total, unit: "/" + item.Total, color: "orange", colorAlpha: 1, bgcolor: "#696969", type: "default" });
                        }
                        trHTML += '<tr><td>' + item.Label + '</td><td>' + item.Y + '</td><td>' + item.Total + '</td></tr>';
                    });
                    $('#records_table').append(trHTML);
                    var ctx = $("#myChart").get(0).getContext("2d");
                    Chart.defaults.global.defaultFontColor = 'white';
                    var myNewChart = new Chart(ctx, {
                        type: 'bar',
                        data: dataT,
                        options: {
                            responsive: true,
                            title: { display: true, text: 'Property Type / Zoning' },
                            legend: { position: 'bottom', fontColor: 'white' },
                            scales: {
                                xAxes: [{ gridLines: { display: false }, display: true, scaleLabel: { display: false, labelString: '' } }],
                                yAxes: [{ gridLines: { display: false }, display: true, scaleLabel: { display: false, labelString: '' }, ticks: { stepSize: 50, beginAtZero: true } }]
                            },
                        }
                    });
                }
            });
        });

        $('#filterByRegionBtn').click(function () {
            var selectedRegion = $('#dropDownId :selected').text();
            $.ajax({
                type: "POST",
                url: "/Home/NewChart",
                dataType: "json",
                data: { selectedRegion: selectedRegion },
                success: function (chData) {
                    var aData = chData;
                    $("#noOfImprovements").empty().append(aData[3]).find('#noOfImprovements');
                    $("#PropertiesCount").empty().append(aData[4]).find('#PropertiesCount');
                    $("#ImprovementsSize").empty().append(aData[5]).find('#ImprovementsSize');
                    $("#OccupationStatus").empty().append(aData[6]).find('#OccupationStatus');
                    $("#PropertiesPercentage").empty().append(aData[7]).find('#PropertiesPercentage');
                    var dsf = aData[7] + '%';
                    $("#propertiesPercentageProgressbar").css({ width: dsf });
                    var aLabels = aData[0];
                    var aDatasets1 = aData[1];
                    var dataT = {
                        labels: aLabels,
                        datasets: [{
                            label: "Clear Data",
                            data: aDatasets1,
                            fill: true,
                            backgroundColor: aData[2],
                            borderColor: aData[2],
                            borderWidth: 1
                        }]
                    };
                    $('#records_table tbody').empty();
                    var trHTML = '';
                    $("#demo").gauge(0, { min: 0, max: 100, unit: "/0", color: "yellow", colorAlpha: 1, bgcolor: "#696969", type: "default" });
                    $("#demo1").gauge(0, { min: 0, max: 100, unit: "/0", color: "red", colorAlpha: 1, bgcolor: "#696969", type: "default" });
                    $("#demo2").gauge(0, { min: 0, max: 100, unit: "/0", color: "white", colorAlpha: 1, bgcolor: "#696969", type: "default" });
                    $("#demo3").gauge(0, { min: 0, max: 100, unit: "/0", color: "orange", colorAlpha: 1, bgcolor: "#696969", type: "default" });
                    $.each(aData[8], function (i, item) {
                        if (item.Label.toLowerCase().trim() == 'public open space') {
                            $("#demo").gauge(item.Y, { min: 0, max: item.Total, unit: "/" + item.Total, color: "yellow", colorAlpha: 3, bgcolor: "#696969", type: "default" });
                        }
                        if (item.Label.toLowerCase().trim() == 'roads') {
                            $("#demo1").gauge(item.Y, { min: 0, max: item.Total, unit: "/" + item.Total, color: "red", colorAlpha: 2, bgcolor: "#696969", type: "default" });
                        }
                        if (item.Label.toLowerCase().trim() == 'agriculture') {
                            $("#demo2").gauge(item.Y, { min: 0, max: item.Total, unit: "/" + item.Total, color: "white", colorAlpha: 1, bgcolor: "#696969", type: "default" });
                        }
                        if (item.Label.toLowerCase().trim() == 'special') {
                            $("#demo3").gauge(item.Y, { min: 0, max: item.Total, unit: "/" + item.Total, color: "orange", colorAlpha: 1, bgcolor: "#696969", type: "default" });
                        }
                        trHTML += '<tr><td>' + item.Label + '</td><td>' + item.Y + '</td><td>' + item.Total + '</td></tr>';
                    });
                    $('#records_table').append(trHTML);
                    $('#myChart').remove();
                    $('#graph-container').append('<canvas id="myChart" style="padding: 0;margin: auto;display: block; "> </canvas>');
                    var ctx = $("#myChart").get(0).getContext("2d");
                    Chart.defaults.global.defaultFontColor = 'white';
                    var myNewChart = new Chart(ctx, {
                        type: 'bar',
                        data: dataT,
                        options: {
                            responsive: true,
                            title: { display: true, text: 'Property Type / Zoning' },
                            legend: { position: 'bottom', fontColor: 'white' },
                            scales: {
                                xAxes: [{ gridLines: { display: false }, display: true, scaleLabel: { display: false, labelString: '' } }],
                                yAxes: [{ gridLines: { display: false }, display: true, scaleLabel: { display: false, labelString: '' }, ticks: { stepSize: 50, beginAtZero: true } }]
                            },
                        }
                    });
                }
            });
        });
        $.ajax({
            type: "POST",
            url: "/Home/NewChart",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (chData) {
                var aData = chData;
                var aLabels = aData[0];
                var aDatasets1 = aData[1];
                var dataT = {
                    labels: aLabels,
                    datasets: [{
                        label: "Clear Data",
                        data: aDatasets1,
                        fill: true,
                        backgroundColor: aData[2],
                        borderColor: aData[2],
                        borderWidth: 1
                    }]
                };
                $('#records_table tbody').empty();
                var trHTML = '';
                $("#demo").gauge(0, { min: 0, max: 100, unit: "/0", color: "yellow", colorAlpha: 1, bgcolor: "#696969", type: "default" });
                $("#demo1").gauge(0, { min: 0, max: 100, unit: "/0", color: "red", colorAlpha: 1, bgcolor: "#696969", type: "default" });
                $("#demo2").gauge(0, { min: 0, max: 100, unit: "/0", color: "white", colorAlpha: 1, bgcolor: "#696969", type: "default" });
                $("#demo3").gauge(0, { min: 0, max: 100, unit: "/0", color: "orange", colorAlpha: 1, bgcolor: "#696969", type: "default" });
                $.each(aData[8], function (i, item) {
                    if (item.Label.toLowerCase().trim() == 'public open space') {
                        $("#demo").gauge(item.Y, { min: 0, max: item.Total, unit: "/" + item.Total, color: "yellow", colorAlpha: 3, bgcolor: "#696969", type: "default" });
                    }
                    if (item.Label.toLowerCase().trim() == 'roads') {
                        $("#demo1").gauge(item.Y, { min: 0, max: item.Total, unit: "/" + item.Total, color: "red", colorAlpha: 2, bgcolor: "#696969", type: "default" });
                    }
                    if (item.Label.toLowerCase().trim() == 'agriculture') {
                        $("#demo2").gauge(item.Y, { min: 0, max: item.Total, unit: "/" + item.Total, color: "white", colorAlpha: 1, bgcolor: "#696969", type: "default" });
                    }
                    if (item.Label.toLowerCase().trim() == 'special') {
                        $("#demo3").gauge(item.Y, { min: 0, max: item.Total, unit: "/" + item.Total, color: "orange", colorAlpha: 1, bgcolor: "#696969", type: "default" });
                    }
                    trHTML += '<tr><td>' + item.Label + '</td><td>' + item.Y + '</td><td>' + item.Total + '</td></tr>';
                });
                $('#records_table').append(trHTML);
                var ctx = $("#myChart").get(0).getContext("2d");
                Chart.defaults.global.defaultFontColor = 'white';
                var myNewChart = new Chart(ctx, {
                    type: 'bar',
                    data: dataT,
                    options: {
                        responsive: true,
                        title: { display: true, text: 'Property Type / Zoning' },
                        legend: { position: 'bottom', fontColor: 'white' },
                        scales: {
                            xAxes: [{ gridLines: { display: false }, display: true, scaleLabel: { display: false, labelString: '' } }],
                            yAxes: [{ gridLines: { display: false }, display: true, scaleLabel: { display: false, labelString: '' }, ticks: { stepSize: 50, beginAtZero: true } }]
                        },
                    }
                });
            }
        });
    </script>
